(()=>{"use strict";var e={791:(e,r,n)=>{n.r(r),n.d(r,{default:()=>t});const t=(0,n(619).connect)("mongodb+srv://".concat(process.env.MONGODB_USER,":").concat(process.env.MONGODB_PASSWORD,"@cluster0.nkdgo.mongodb.net/").concat(process.env.MONGODB_DB,"?retryWrites=true&w=majority"),{useNewUrlParser:!0,useUnifiedTopology:!0,useFindAndModify:!1,useCreateIndex:!0}).then((function(){return console.log("DataBase Connected")}),(function(e){return console.log("DataBase Error ",e)}))},334:e=>{e.exports=require("dotenv")},605:e=>{e.exports=require("http")},470:e=>{e.exports=require("moment")},619:e=>{e.exports=require("mongoose")},395:e=>{e.exports=require("socket.io")}},r={};function n(t){var a=r[t];if(void 0!==a)return a.exports;var u=r[t]={exports:{}};return e[t](u,u.exports,n),u.exports}n.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return n.d(r,{a:r}),r},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=require("express");var r=n.n(e);const t=require("morgan");var a=n.n(t);const u=require("cors");var s=n.n(u);const o=require("express-graphql"),i=(0,require("graphql").buildSchema)("\n  type Query {\n\toneWord(word: String!): [Word!]!\n\toneUser(username: String!): User! \n\tuserByDepartment(department: String!): [User!]!\n  }\n\n  type Mutation{\n\tcreateWord(word: String!, published: String!, designerby: String!, username: String!): Word!\n\tnewUser(name: String!, lastname: String!, gender: String!, email: String!, username: String!, password: String!, department: String!, role: String!, access: Access): User!\n\tlogin(username: String!, password: String!): User!\n\toneUser(username: String!): User!\n  }\n\n  type Word{\n\tword: String!\n\tpublished: String!\n\tdesignerby: String!\n\tusername: String!\n\tcreated_at: String!\n\tupdated_at: String!\n  }\n\n  type User{\n\tname: String!\n\tlastname: String!\n\tgender: String!\n\tusername: String!\n\temail: String!\n\tdepartment: String!\n\tactive: Boolean!\n\taccess: AccessI\n\trole: String!\n\tcreated_at: String!\n\tupdated_at: String!\n  }\n\n  type AccessI{\n\tmarketing: Boolean\n\trrhh: Boolean\n\ttech: Boolean\n\tspanish: Boolean\n\tebook: Boolean\n  }\n\n  input Access{\n\tmarketing: Boolean\n\trrhh: Boolean\n\ttech: Boolean\n\tspanish: Boolean\n\tebook: Boolean\n  }\n\n  type Login{\n\ttoken: String\n  }\n"),c=require("@babel/runtime/helpers/asyncToGenerator");var p=n.n(c);const f=require("@babel/runtime/regenerator");var d=n.n(f);const l=require("bcrypt");var m=n(470);function h(){return m().format("MMMM Do YYYY, h:mm:ss a")}function y(e,r){return g.apply(this,arguments)}function g(){return(g=p()(d().mark((function e(r,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.compareSync)(r,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return S.apply(this,arguments)}function S(){return(S=p()(d().mark((function e(r){var n,t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,l.genSaltSync)(10),t=(0,l.hashSync)(r,n),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=n(619),v=(0,b.Schema)({name:{type:String},lastname:{type:String},gender:{type:String},email:{type:String},username:{type:String},password:{type:String},department:{type:String},active:{type:Boolean},access:{marketing:{type:Boolean},rrhh:{type:Boolean},tech:{type:Boolean},spanish:{type:Boolean},ebook:{type:Boolean}},role:{type:String},created_at:{type:String},updated_at:{type:String}});const x=(0,b.model)("users",v);function k(e,r,n,t,a,u,s,o,i,c,p,f){return B.apply(this,arguments)}function B(){return(B=p()(d().mark((function e(r,n,t,a,u,s,o,i,c,p,f,l){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,d){return x.create({name:r,lastname:n,gender:t,email:a,username:u,password:s,department:o,role:i,active:c,access:p,created_at:f,updated_at:l},(function(r,n){if(r)return d(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return O.apply(this,arguments)}function O(){return(O=p()(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return x.findOne({username:r},(function(r,t){if(r)return n(r);e(t)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,r){return q.apply(this,arguments)}function q(){return(q=p()(d().mark((function e(r,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return x.updateOne({username:r},{updated_at:n},(function(r,n){if(r)return t(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return M.apply(this,arguments)}function M(){return(M=p()(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return x.find({department:r},(function(r,t){if(r)return n(r);e(t)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e,r,n,t,a,u,s,o,i,c,p,f){return T.apply(this,arguments)}function T(){return(T=p()(d().mark((function e(r,n,t,a,u,s,o,i,c,p,f,l){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(r,n,t,a,u,s,o,i,c,p,f,l);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return j.apply(this,arguments)}function j(){return(j=p()(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,r){return G.apply(this,arguments)}function G(){return(G=p()(d().mark((function e(r,n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(r,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return N.apply(this,arguments)}function N(){return(N=p()(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y=(0,b.Schema)({word:{type:String},published:{type:String},designerby:{type:String},username:{type:String},created_at:{type:String},updated_at:{type:String}});const C=(0,b.model)("worduploads",Y);function E(e,r,n,t,a,u){return I.apply(this,arguments)}function I(){return(I=p()(d().mark((function e(r,n,t,a,u,s){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){return C.create({word:r,published:n,designerby:t,username:a,created_at:u,updated_at:s},(function(r,n){if(r)return o(r);e(n)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return F.apply(this,arguments)}function F(){return(F=p()(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return C.find({word:r},(function(r,t){if(r)return n(r);e(t)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return Q.apply(this,arguments)}function Q(){return(Q=p()(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return C.findOne({word:r},(function(r,t){if(r)return n(r);e(t)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,r,n,t,a,u){return z.apply(this,arguments)}function z(){return(z=p()(d().mark((function e(r,n,t,a,u,s){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(r,n,t,a,u,s);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return K.apply(this,arguments)}function K(){return(K=p()(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){return Z.apply(this,arguments)}function Z(){return(Z=p()(d().mark((function e(r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const $={createWord:function(){var e=p()(d().mark((function e(r,n,t){var a,u,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Word,e.next=3,X(r.word);case 3:if(a=e.sent,u=h(),a){e.next=10;break}return e.next=8,V(r.word,r.published,r.designerby,r.username,u,u);case 8:return s=e.sent,e.abrupt("return",s);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e)})));return function(r,n,t){return e.apply(this,arguments)}}(),oneWord:(ae=p()(d().mark((function e(r,n,t,a){var u;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Word,e.next=3,J(r.word);case 3:if(u=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",u);case 7:case"end":return e.stop()}}),e)}))),function(e,r,n,t){return ae.apply(this,arguments)}),newUser:(te=p()(d().mark((function e(r,n,t){var a,u,s,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.User,a=h(),e.next=4,D(r.username);case 4:return u=e.sent,e.next=7,w(r.password);case 7:if(s=e.sent,u){e.next=13;break}return e.next=11,W(r.name,r.lastname,r.gender,r.email,r.username,s,r.department,r.role,!0,r.access,a,a);case 11:return o=e.sent,e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)}))),function(e,r,n){return te.apply(this,arguments)}),oneUser:(ne=p()(d().mark((function e(r,n,t){var a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.User,e.next=3,D(r.username);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,a;case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)}))),function(e,r,n){return ne.apply(this,arguments)}),userByDepartment:(re=p()(d().mark((function e(r,n,t){var a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.User,e.next=3,R(r.department);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))),function(e,r,n){return re.apply(this,arguments)}),login:(ee=p()(d().mark((function e(r,n,t){var a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.User,e.next=3,D(r.username);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:if(1!=a.active){e.next=13;break}if(!y(r.password,a.password)){e.next=11;break}return e.next=10,A(a.username,h());case 10:return e.abrupt("return",a);case 11:e.next=14;break;case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e)}))),function(e,r,n){return ee.apply(this,arguments)})};var ee,re,ne,te,ae,ue=r()(),se=n(605).createServer(ue),oe=n(395)(se,{cors:{origin:"*",methods:["GET","POST"],allowedHeaders:["content-type"]}});n(334).config(),ue.set("port",process.env.PORT),ue.use(a()("dev")),ue.use(s()({origin:"*"})),ue.use(r().urlencoded({extended:!0})),ue.use(r().json()),n(791),ue.use("/graphql",(0,o.graphqlHTTP)({schema:i,rootValue:$,context:{Word:C,User:x},graphiql:!0})),oe.on("connect",(function(e){console.log("Connected ",e.id),console.log(e),oe.emit("active")})),se.listen(process.env.PORT,(function(){console.log("Server run on port",process.env.PORT)}))})()})();